import{d as U,A as g,C as S,D as Q,z as D,o as J,E as X,b as I,c as K,e as a,G as y,H as Y,f as C,w as $,g as k,I as Z,J as tt,B as O,p as et,j as ot,l as R,K as st,M as lt,h as V,N as q,u as P}from"./index-cb83f219.js";const nt=_=>(et("data-v-7d02193c"),_=_(),ot(),_),it={class:"guider-content"},at=nt(()=>a("h1",null,"第一步",-1)),rt={class:"guider-footer flex justify-between w-full"},ut=U({__name:"Guider",props:{current:[HTMLElement,Object,String],options:{required:!0,type:Array},show:Boolean},emits:["close","update:show","update:current"],setup(_,{emit:d}){const n=_,h=g(0),x=S({get(){return n.current&&(h.value=n.options.findIndex(t=>t.target===n.current)),h.value},set(t){const o=n.options[t];o?(h.value=t,d("update:current",o.target)):(h.value=0,d("close"),d("update:current",n.options[0].target),d("update:show",!1))}}),l=g(),w=g(n.show),e=Q({width:0,height:0,left:0,top:0,right:0,bottom:0}),m=S(()=>{var o;const t=n.current??((o=n.options[h.value])==null?void 0:o.target);if(t)return typeof t=="string"?document.querySelector(t):t instanceof HTMLElement?t:t.$el}),v=S(()=>{const{offsetWidth:t,offsetHeight:o}=l.value||{offsetWidth:0,offsetHeight:0},{left:i,top:f,right:p,bottom:u,height:b,width:c}=e,s={main:"horizontal",sub:"vertical",horizontal:"left",vertical:"top"};return Math.max(i,p)>=Math.max(f,u)?(s.main="horizontal",s.sub="vertical",s.horizontal=i>p?"left":"right",f+b/2<o/2&&u+b/2>o/2?s.vertical="top":f+b/2>o/2&&u+b/2<o/2?s.vertical="bottom":s.vertical="center"):(s.main="vertical",s.sub="horizontal",s.vertical=f>u?"top":"bottom",i+c/2<t/2&&p+c/2>t/2?s.horizontal="left":i+c/2>t/2&&p+c/2<t/2?s.horizontal="right":s.horizontal="center"),s}),W=S(()=>{var M,j,A,G,L,N;const t={left:0,top:0};if(!n.show||!l.value||!w.value)return t;const{top:o,left:i,right:f,bottom:p,height:u,width:b}=e,c=v.value,s=c[c.main],T=c[c.sub],E=10,F=(c.main==="horizontal"?(M=l.value)==null?void 0:M.offsetWidth:(j=l.value)==null?void 0:j.offsetHeight)??0;return t[s]=e[s]-F-E,s==="right"?t.left=i+b+E:s==="bottom"&&(t.top=o+u+E),T==="center"?c.main==="horizontal"?t.top=o+u/2-(((A=l.value)==null?void 0:A.offsetHeight)??0)/2:t.left=i+b/2-(((G=l.value)==null?void 0:G.offsetWidth)??0)/2:t[T]=e[T],t.left===void 0&&(t.left=window.innerWidth-t.right-((L=l.value)==null?void 0:L.offsetWidth)),t.top===void 0&&(t.top=window.innerHeight-t.bottom-((N=l.value)==null?void 0:N.offsetHeight)),t}),H=S(()=>{const t={left:-16,top:-16};if(!n.show||!l.value||!w.value)return t;const o=v.value,i=o[o.main],f=o[o.sub],{offsetHeight:p=0,offsetWidth:u=0}=l.value??{};return i==="left"?t.left=(u??0)-4:i==="top"&&(t.top=(p??0)-4),o.main==="horizontal"&&(f==="center"?t.top=p/2-10:f==="bottom"?t.top=p-e.height/2-10:t.top=e.height/2-10),o.main==="vertical"&&(f==="center"?t.left=u/2-10:f==="right"?t.left=u-e.width/2-10:t.left=e.width/2-10),t});function r(){const t=m.value;if(!t)return;const o=tt(t);e.left=o[0],e.top=o[1],e.width=t.offsetWidth,e.height=t.offsetHeight,e.right=window.innerWidth-e.width-e.left,e.bottom=window.innerHeight-e.height-e.top}D(()=>[m.value,n.show],r),D(()=>n.show,t=>{w.value=t},{flush:"post"}),J(()=>{window.addEventListener("resize",r)}),X(()=>{window.removeEventListener("resize",r)});function z(){x.value+=1}function B(){d("close"),d("update:show",!1)}return(t,o)=>{const i=O;return I(),K(Z,{to:"body"},[a("div",{class:"guider",style:y(`display: ${_.show?"static":"none"}`)},[a("div",{class:"guider-left",style:y(`border-left: ${e.left-2}px solid rgba(0, 0, 0, 0.25);`)},null,4),a("div",{class:"guider-top",style:y(`left: ${e.left-2}px; width: ${e.width+4}px; border-top: ${e.top-2}px solid rgba(0, 0, 0, 0.25);`)},null,4),a("div",{class:"guider-right",style:y(`left: ${e.left+e.width+2}px; background-color: rgba(0, 0, 0, 0.25)`)},null,4),a("div",{class:"guider-bottom",style:y(`left: ${e.left-2}px; width: ${e.width+4}px; top: ${e.top+e.height+2}px`)},null,4),a("div",{ref_key:"doc",ref:l,class:"guider-doc flex flex-col justify-between rounded-md",style:y(`left: ${W.value.left}px;top:${W.value.top}px`)},[a("div",{class:"arrow",style:y(`left: ${H.value.left}px; top: ${H.value.top}px; border-${v.value[v.value.main]}-color: white`)},null,4),a("div",it,[at,a("div",null,[Y(t.$slots,"default",{},void 0,!0)])]),a("div",rt,[C(i,{onClick:B},{default:$(()=>[k("关闭")]),_:1}),C(i,{type:"primary",onClick:z},{default:$(()=>[k("下一步")]),_:1})])],4)],4)])}}});const ct=R(ut,[["__scopeId","data-v-7d02193c"]]),ft={class:"test-page"},dt=U({__name:"Test",setup(_){const d=st();d.setAuthorities(["personal:edit","personal:remove"]);const n=d.useAuth("personal:edit",H=>console.log("hi, "+H)),h=()=>console.log("say hi");n("jack");const x=g(),l=g(),w=g();let e=[];const m=g(),v=g(!1);function W(){console.log("hello")}return J(()=>{m.value=x.value,e.push({target:x.value,doc:w.value},{target:l.value,doc:w.value})}),(H,r)=>{const z=O,B=lt("auth");return I(),V("div",ft,[a("div",null,[q((I(),K(z,{onClick:r[0]||(r[0]=t=>v.value=!0)},{default:$(()=>[k("新手引导1")]),_:1})),[[B,"personal:edit"]]),C(z,{class:"btn1",ref_key:"btn1",ref:x,type:"primary",onClick:r[1]||(r[1]=t=>m.value=l.value)},{default:$(()=>[k("button 1")]),_:1},512),C(z,{class:"btn2",ref_key:"btn2",ref:l,type:"primary",onClick:r[2]||(r[2]=t=>m.value=x.value)},{default:$(()=>[k("button 2")]),_:1},512),q((I(),V("span",{onClick:h,class:"ml-40 p-2"},[k("test")])),[[B,"hello"]])]),C(P(ct),{current:m.value,options:P(e),show:v.value,"onUpdate:show":r[3]||(r[3]=t=>v.value=t)},{default:$(()=>[a("div",{ref_key:"doc",ref:w,onClick:W},"功能指引",512)]),_:1},8,["current","options","show"])])}}});const ht=R(dt,[["__scopeId","data-v-0a39d9f4"]]);export{ht as default};
//# sourceMappingURL=Test-a20ec22e.js.map
